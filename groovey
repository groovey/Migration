#!/usr/bin/env php
<?php

set_time_limit(0);

require_once __DIR__.'/vendor/autoload.php';

use Symfony\Component\Console\Application;
use Doctrine\DBAL\Configuration;
use Doctrine\DBAL\DriverManager;

$db = [
        'dbname'   => 'migration',
        'user'     => 'root',
        'password' => 'webdevel',
        'host'     => 'localhost',
        'driver'   => 'pdo_mysql',
    ];

$config = new Configuration();
$conn   = DriverManager::getConnection($db, $config);
$app    = new Application();

$container['db'] = $conn;

$app->addCommands([
        new Groovey\Migration\Commands\About(),
        new Groovey\Migration\Commands\Init($container),
        new Groovey\Migration\Commands\Reset($container),
        new Groovey\Migration\Commands\Listing($container),
        new Groovey\Migration\Commands\Drop($container),
        new Groovey\Migration\Commands\Status($container),
        new Groovey\Migration\Commands\Create($container),
        new Groovey\Migration\Commands\Up($container),
        new Groovey\Migration\Commands\Down($container),
    ]);

$status = $app->run();

exit($status);
